
//Skeleton Program code for the AQA A Level Paper 1 Summer 2020 examination
//this code should be used in conjunction with the Preliminary Material
//written by the AQA Programmer Team
//developed in the Visual Studio Community Edition programming environment
//The 2010 Austin suicide attack occurred on February 18, 2010, when Andrew Joseph Stack III deliberately crashed his single-engine Piper Dakota light aircraft into Building I of the Echelon office complex in Austin, Texas, United States,[5] killing himself and Internal Revenue Service (IRS) manager Vernon Hunter.[6] Thirteen others were injured, two severely. The four-story[7][8] office building housed an IRS field office occupying the top three floors, along with a couple of private businesses on the first floor. Prior to the crash, Stack had posted a suicide note to his website, expressing his disillusionment with corporations and government agencies such as the IRS. Stack is also suspected of having set fire that morning to his two-story North Austin house, which was mostly destroyed.

In the aftermath, there was increased debate over the policies of the IRS, and different forms of protest. In response to the attack, the IRS spent more than $38.6 million,[9] with $6.4 million spent to recover and resume work at the building, and over $32 million spent to increase security at other IRS sites in the U.S. However, the spending on security changes was questioned as being ineffective, as none of it would actually prevent airplanes from crashing into the buildings. The building was repaired by December 2011.
Contents

    1 Joseph Stack
    2 Events
        2.1 Suicide note
    3 Aftermath
        3.1 Economic costs to IRS
    4 Reaction
    5 See also
    6 References
    7 External links

Joseph Stack
"Joe Stack" redirects here. For the American basketball player, see Joe Stack (basketball).
Stack playing bass guitar in The Billy Eli Band (2006).

Andrew Joseph Stack III (August 31, 1956 – February 18, 2010) lived in the Scofield Farms neighborhood in North Austin, and worked as an embedded software consultant.[10][11][12] He grew up in Pennsylvania and had two brothers and two sisters. Stack was orphaned at age four, and spent some time at a Catholic orphanage.[13] He graduated from the Milton Hershey School in 1974 and studied engineering at Harrisburg Area Community College from 1975 to 1977, but did not graduate.[14][15] His first marriage, to Ginger Stack, which ended in divorce, produced a daughter, Samantha Bell.[13][16] In 2007, Stack married Sheryl Housh, who had a daughter from a previous marriage.[13]

In 1985, Stack, along with his first wife, incorporated Prowess Engineering. In 1994, he failed to file a state tax return. In 1998, the Stacks divorced, and a year later his wife filed Chapter 11 bankruptcy, citing Federal tax liabilities totaling nearly $126,000. In 1995, Stack started Software Systems Service Corp, which was suspended in 2004 for non-payment of state taxes.[13]

Stack obtained a pilot's certificate in 1994 and owned a Velocity Elite XL-RG plane, in addition to the Piper Dakota (aircraft registration N2889D) he flew into the Echelon building.[13] He had been using the Georgetown Municipal Airport for four and a half years and paid $236.25 a month to rent a hangar.[1] There has been speculation that Stack replaced seats on his aircraft with extra drums of fuel prior to the collision.[17]

Stack's accountant confirmed that at the time of the incident, he was being audited by the Internal Revenue Service for failure to report income.[18]
Events

About an hour before the crash, Stack allegedly set fire to his $230,000[17] house located on Dapplegrey Lane in North Austin.[10][19] (The house was mostly destroyed in the fire.)[6][20] He then drove to a hangar he rented at Georgetown Municipal Airport, approximately 20 miles to the north.[21] He boarded his single-engine Piper Dakota airplane and took off around 9:45 a.m. Central Standard Time.[22][23][24][25] He indicated to the control tower his flight would be "going southbound, sir."[13] After taking off, his last words were "thanks for your help, have a great day."[26]

About ten minutes later, his plane descended and collided at full speed with Echelon I, a building containing offices for 190 IRS employees, resulting in a large fireball and explosion.[22][27][28] The building is located near the intersection of Research Boulevard (U.S. Route 183) and Mopac Expressway (Loop 1).
Suicide note
Wikinews has related news:

    Plane crashes into office block in Austin, Texas

On the morning of the crash, Stack posted a suicide note on his website, embeddedart.com.[12][29][30][31][32] The HTML source code of the web page shows the letter was composed using Microsoft Word starting two days prior, February 16, at 19:24Z (1:24 p.m. CST).[33] The document also shows that it was saved 27 times with the last being February 18 at 06:42Z (12:42 a.m. CST).[33]

In the note, he begins by expressing displeasure with the government, the bailout of financial institutions, politicians, the conglomerate companies of General Motors, Enron and Arthur Andersen, unions, drug and health care insurance companies, and the Catholic Church.[32] He then describes his life as an engineer, including his meeting with a poor widow who never got the pension benefits she was promised, the effect of Section 1706 of the Tax Reform Act of 1986 on independent contractor engineers, the September 11 attacks, airline bailouts that benefited only the airlines but not the suffering engineers, and how a CPA he hired seemed to side with the government to take extra tax money from him.

The note also mentions Stack's having issues with taxes, debt, and the IRS and his having a long-running feud with the organization.[34] While the IRS also has a larger regional office in Austin, the field office located in Echelon I performed tax audits, seizures, investigations and collections.[34]

The note ended with:

    I saw it written once that the definition of insanity is repeating the same process over and over and expecting the outcome to suddenly be different. I am finally ready to stop this insanity. Well, Mr. Big Brother IRS man, let's try something different; take my pound of flesh and sleep well.

    The communist creed: From each according to his ability, to each according to his need.

    The capitalist creed: From each according to his gullibility, to each according to his greed.
    — Joe Stack (1956–2010), 02/18/2010[32]

Aftermath

Vernon Hunter, a 68-year-old Revenue Officer Group Manager for the IRS, was killed in the incident along with Joseph Stack.[6][35] Thirteen people were reported as injured, two of them critically. Debris from the crash reportedly shattered the windshield of a car being driven on the southbound access road of Route 183 in front of the building.[3] Another driver on the southbound access road of Route 183 had his windows and sunroof shattered during the impact, and had debris fall inside his car, yet escaped uninjured.[6][36] Robin DeHaven, a glass worker and former combat engineer for the United States Army, saw the collision while commuting to a customer's house for his job, and used the extension ladder on his truck to rescue six people from the 2nd floor of the building.[37] By coincidence, the Travis County Hazardous Materials Team — an inter-agency group of firefighters from outside the City of Austin — had just assembled for training across the freeway from the targeted building, observed the low and fast flight of Stack's plane, and heard the blast impact.[38] They immediately responded, attacking the fire and initiating search-and-rescue.[38] Several City of Austin fire engines for the area of the Echelon building were already deployed at the fire at Stack's home at the time of the impact.[38]

Georgetown Municipal Airport was temporarily evacuated while a bomb disposal team searched Stack's abandoned vehicle.[39]

An inspection into the Echelon building's structural integrity was concluded six days after the incident and a preliminary decision was made to repair the building rather than demolish it.[40] Those repairs were substantially complete by December 2011.
Economic costs to IRS

The IRS spent more than $38.6 million because of the suicide attack.[9][41]

For the immediate response, document recovery, and to resume operations at the center, the IRS spent USD $6,421,942.[9] Of this amount, USD $3,258,213 was spent on document recovery.[9]

Also, the IRS spent a total of USD $32.3 million to improve IRS building security across the United States, with USD $30.5 million for more security guards.[9] The IRS said, because of the 2010 Austin terrorist attack and the emergency plans in place, there was no direct budgetary impact on the IRS's ability to provide taxpayer services or enforce tax laws.[9]

An additional $1,236,634 was spent on a security risk assessment to be performed by the private Georgia based logistical and engineering services firm Unified Consultants Group, Inc. A July 25, 2012 audit, released shortly after the incident cost analysis, performed by the Treasury Inspector General for Tax Administration, determined that the contract was mismanaged by the IRS.[42][43] The security-review process was determined to have had multiple problems, and many of the sites were not inspected by the contractor. The audit placed the blame on the IRS agency's individuals responsible for defining, negotiating, and administering the contract, with potentially 100% of funds being used inefficiently and the security improvements of IRS sites may have been ineffective.[43]
Reaction

The United States Department of Homeland Security issued a statement saying that the incident did not appear to be linked to organized international terrorist groups.[22] White House spokesman Robert Gibbs reaffirmed what Homeland Security said, and that President Barack Obama was briefed on the incident.[44] The President expressed his concern and commended the courageous actions of the first responders.[44] The North American Aerospace Defense Command (NORAD) launched two F-16 fighter aircraft from Ellington Airport in Houston, Texas, to conduct an air patrol in response to the crash. That action was reported as standard operating procedure in this situation.[29]

The company hosting embeddedart.com, T35 Hosting, took Stack's website offline "due to the sensitive nature of the events that transpired in Texas this morning and in compliance with a request from the FBI."[45][46] Several groups supporting Stack on the social networking website Facebook appeared following the incident and the news of the accompanying manifesto. These were immediately shut down by Facebook staff.[47][48][49]

Austin police chief Art Acevedo stated that the incident was not the action of a major terrorist organization. He also cited "some heroic actions on the part of federal employees" that "will be told at the appropriate time."[50]

The Federal Bureau of Investigation stated that it was investigating the incident "as a criminal matter of an assault on a federal officer" and that it was not being considered terrorism at this time.[51]

However, two members of the United States House of Representatives, both of whose districts include the Austin area, made statements to the contrary. Rep. Lloyd Doggett (D-Texas) stated, "Like the larger-scale tragedy in Oklahoma City, this was a cowardly act of domestic terrorism." Mike McCaul (R-Texas), told a reporter that, "it sounds like it [was a terrorist attack] to me." Georgetown University Professor Bruce Hoffman stated that for this to be considered an act of terrorism, "there has to be some political motive and it has to send a broader message that seeks some policy change. From what I've heard, that doesn't appear to be the case. It appears he was very mad at the [IRS] and this was a cathartic outburst of violence. His motivation was the key."[52] A USA Today headline used the term "a chilling echo of terrorism."[28]

Citing the copy of Joseph Stack's note posted online,[32] blogger Joan McCarter observed on the Daily Kos website that, "Obviously Stack was not a mentally healthy person, and he was embittered at capitalism, including crony capitalism, and health insurance companies and the government." She also stated that Stack could not be connected with the Tea Party movement, but argued that the incident "should inject a bit of caution into the anti-government flame-throwers on the right."[53] The website Ace of Spades HQ disputed any connection to the movement and additionally stated Stack was not "right wing", citing Stack's criticism of politicians for not doing anything about health care reform.[54]

In an interview with ABC's Good Morning America, Joe Stack's adult daughter, Samantha Bell, who now lives in Norway, stated initially that she considered her father to be a hero, because she felt that now people might listen. While she does not agree with his specific actions involving the plane crash, she does agree with his actions about speaking out against "injustice" and "the government."[16] Bell subsequently retracted aspects of her statement, saying her father was "not a hero" and adding, "We are mourning for Vernon Hunter."[55]

Five days after her husband Vernon Hunter's death, Valerie Hunter filed a wrongful death lawsuit against Sheryl Mann Stack, Andrew Joseph Stack's widow in federal District Court. The lawsuit alleges that Sheryl had a duty to "avoid a foreseeable risk of injury to others," including her late husband and failed to do so by not warning others about her late husband. The lawsuit also mentions that Stack was required by law to fly his plane at an altitude 1,000 feet (305 m) above the highest obstacle.[56][needs update] At a March 8, 2010, benefit event, Stack's widow, Sheryl, publicly offered condolences for the victims of the attack.[57]

Iowa congressman Steve King (R-Iowa) has made several statements regarding Stack including,

    I think if we'd abolished the IRS back when I first advocated it, he wouldn't have a target for his airplane. And I'm still for abolishing the IRS, I've been for it for thirty years and I'm for a national sales tax (in its place).[58][59]

Academic and activist Noam Chomsky cited Joe Stack's letter as indicative of some of the public sentiment in the U.S., stated that several of Stack's assertions are accurate or based on real grievances, and urged people to "help" the Joseph Stacks of the world get involved in constructive popular movements instead of letting the Joseph Stacks "destroy themselves, and maybe the world," in order to prevent a process similar to how legitimate and valid popular grievances of the German people in the 1920s and 1930s were manipulated by the Nazis towards violence and away from constructive ends.[60][61]

The Internal Revenue Service formally designates certain individuals as potentially dangerous taxpayers (PDTs). In response to an inquiry after the attack, an IRS spokesperson declined to state whether Stack had been designated as a PDT.[62] 
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;






namespace FoodCS
{

    class Household
    {
        private static Random rnd = new Random();
        protected double chanceEatOutPerDay;
        protected int xCoord, yCoord, ID;
        protected static int nextID = 1;

        public Household(int x, int y)
        {
            xCoord = x;
            yCoord = y;
            chanceEatOutPerDay = rnd.NextDouble();
            ID = nextID;
            nextID++;
        }

        public string GetDetails()
        {
            string details;
            details = ID.ToString() + "     Coordinates: (" + xCoord.ToString() + ", " + yCoord.ToString() + ")     Eat out probability: " + chanceEatOutPerDay.ToString();
            return details;
        }

        public double GetChanceEatOut()
        {
            return chanceEatOutPerDay;
        }

        public int GetX()
        {
            return xCoord;
        }

        public int GetY()
        {
            return yCoord;
        }
    }

    class Settlement
    {
        private static Random rnd = new Random();
        protected int startNoOfHouseholds, xSize, ySize;
        protected List<Household> households = new List<Household>();

        public Settlement()
        {
            xSize = 1000;
            ySize = 1000;
            startNoOfHouseholds = 250;
            CreateHouseholds();
        }

        public int GetNumberOfHouseholds()
        {
            return households.Count;
        }

        public int GetXSize()
        {
            return xSize;
        }

        public int GetYSize()
        {
            return ySize;
        }

        public void GetRandomLocation(ref int x, ref int y)
        {
            x = Convert.ToInt32(rnd.NextDouble() * xSize);
            y = Convert.ToInt32(rnd.NextDouble() * ySize);
        }

        public void CreateHouseholds()
        {
            for (int count = 0; count < startNoOfHouseholds; count++)
            {
                AddHousehold();
            }
        }

        public void AddHousehold()
        {
            int x = 0, y = 0;
            GetRandomLocation(ref x, ref y);
            Household temp = new Household(x, y);
            households.Add(temp);
        }

        public void DisplayHouseholds()
        {
            Console.WriteLine("\n**********************************");
            Console.WriteLine("*** Details of all households: ***");
            Console.WriteLine("**********************************\n");
            foreach (var h in households)
            {
                Console.WriteLine(h.GetDetails());
            }
            Console.WriteLine();
        }

        public bool FindOutIfHouseholdEatsOut(int householdNo, ref int x, ref int y)
        {
            double eatOutRNo = rnd.NextDouble();
            x = households[householdNo].GetX();
            y = households[householdNo].GetY();
            if (eatOutRNo < households[householdNo].GetChanceEatOut())
            {
                return true;
            }
            else
            {
                return false;
            }
        }
    }

    class LargeSettlement : Settlement
    {
        public LargeSettlement(int extraXSize, int extraYSize, int extraHouseholds)
            : base()
        {
            xSize += extraXSize;
            ySize += extraYSize;
            startNoOfHouseholds += extraHouseholds;
            for (int count = 1; count < extraHouseholds + 1; count++)
            {
                AddHousehold();
            }
        }
    }

    class Outlet
    {
        private static Random rnd = new Random();
        protected int visitsToday, xCoord, yCoord, capacity, maxCapacity;
        protected double dailyCosts;

        public Outlet(int xCoord, int yCoord, int maxCapacityBase)
        {
            this.xCoord = xCoord;
            this.yCoord = yCoord;
            capacity = Convert.ToInt32(maxCapacityBase * 0.6);
            maxCapacity = maxCapacityBase + Convert.ToInt32(rnd.NextDouble() * 50) - Convert.ToInt32(rnd.NextDouble() * 50);
            dailyCosts = maxCapacityBase * 0.2 + capacity * 0.5 + 100;
            NewDay();
        }

        public int GetCapacity()
        {
            return capacity;
        }

        public int GetX()
        {
            return xCoord;
        }

        public int GetY()
        {
            return yCoord;
        }

        public void AlterDailyCost(double amount)
        {
            dailyCosts += amount;
        }

        public int AlterCapacity(int change)
        {
            int oldCapacity = capacity;
            capacity += change;
            if (capacity > maxCapacity)
            {
                capacity = maxCapacity;
                return maxCapacity - oldCapacity;
            }
            else if (capacity < 0)
            {
                capacity = 0;
            }
            dailyCosts = maxCapacity * 0.2 + capacity * 0.5 + 100;
            return change;
        }

        public void IncrementVisits()
        {
            visitsToday++;
        }

        public void NewDay()
        {
            visitsToday = 0;
        }

        public double CalculateDailyProfitLoss(double avgCostPerMeal, double avgPricePerMeal)
        {
            return (avgPricePerMeal - avgCostPerMeal) * visitsToday - dailyCosts;
        }

        public string GetDetails()
        {
            string details = "";
            details = "Coordinates: (" + xCoord.ToString() + ", " + yCoord.ToString() + ")     Capacity: " + capacity.ToString() + "      Maximum Capacity: ";
            details += maxCapacity.ToString() + "      Daily Costs: " + dailyCosts.ToString() + "      Visits today: " + visitsToday.ToString();
            return details;
        }
    }

    class Company
    {
        private static Random rnd = new Random();
        protected string name, category;
        protected double balance, reputationScore, avgCostPerMeal, avgPricePerMeal, dailyCosts, familyOutletCost, fastFoodOutletCost, namedChefOutletCost, fuelCostPerUnit, baseCostOfDelivery;
        protected List<Outlet> outlets = new List<Outlet>();
        protected int familyFoodOutletCapacity, fastFoodOutletCapacity, namedChefOutletCapacity;

        public Company(string name, string category, double balance, int x, int y, double fuelCostPerUnit, double baseCostOfDelivery)
        {
            familyOutletCost = 1000;
            fastFoodOutletCost = 2000;
            namedChefOutletCost = 15000;
            familyFoodOutletCapacity = 150;
            fastFoodOutletCapacity = 200;
            namedChefOutletCapacity = 50;
            this.name = name;
            this.category = category;
            this.balance = balance;
            this.fuelCostPerUnit = fuelCostPerUnit;
            this.baseCostOfDelivery = baseCostOfDelivery;
            reputationScore = 100;
            dailyCosts = 100;
            if (category == "fast food")
            {
                avgCostPerMeal = 5;
                avgPricePerMeal = 10;
                reputationScore += rnd.NextDouble() * 10 - 8;
            }
            else if (category == "family")
            {
                avgCostPerMeal = 12;
                avgPricePerMeal = 14;
                reputationScore += rnd.NextDouble() * 30 - 5;
            }
            else
            {
                avgCostPerMeal = 20;
                avgPricePerMeal = 40;
                reputationScore += rnd.NextDouble() * 50;
            }
            OpenOutlet(x, y);
        }

        public string GetName()
        {
            return name;
        }

        public int GetNumberOfOutlets()
        {
            return outlets.Count;
        }

        public double GetReputationScore()
        {
            return reputationScore;
        }

        public void AlterDailyCosts(double change)
        {
            dailyCosts += change;
        }

        public void AlterAvgCostPerMeal(double change)
        {
            avgCostPerMeal += change;
        }

        public void AlterFuelCostPerUnit(double change)
        {
            fuelCostPerUnit += change;
        }

        public void AlterReputation(double change)
        {
            reputationScore += change;
        }

        public void NewDay()
        {
            foreach (var o in outlets)
            {
                o.NewDay();
            }
        }

        public void AddVisitToNearestOutlet(int x, int y)
        {
            int nearestOutlet = 0;
            double nearestOutletDistance, currentDistance;
            nearestOutletDistance = Math.Sqrt((Math.Pow(outlets[0].GetX() - x, 2)) + (Math.Pow(outlets[0].GetY() - y, 2)));
            for (int current = 1; current < outlets.Count; current++)
            {
                currentDistance = Math.Sqrt((Math.Pow(outlets[current].GetX() - x, 2)) + (Math.Pow(outlets[current].GetY() - y, 2)));
                if (currentDistance < nearestOutletDistance)
                {
                    nearestOutletDistance = currentDistance;
                    nearestOutlet = current;
                }
            }
            outlets[nearestOutlet].IncrementVisits();
        }

        public string GetDetails()
        {
            string details = "";
            details += "Name: " + name + "\nType of business: " + category + "\n";
            details += "Current balance: " + balance.ToString() + "\nAverage cost per meal: " + avgCostPerMeal.ToString() + "\n";
            details += "Average price per meal: " + avgPricePerMeal.ToString() + "\nDaily costs: " + dailyCosts.ToString() + "\n";
            details += "Delivery costs: " + CalculateDeliveryCost().ToString() + "\nReputation: " + reputationScore.ToString() + "\n\n";
            details += "Number of outlets: " + outlets.Count.ToString() + "\nOutlets\n";
            for (int current = 1; current < outlets.Count + 1; current++)
            {
                details += current + ". " + outlets[current - 1].GetDetails() + "\n";
            }
            return details;
        }

        public string ProcessDayEnd()
        {
            string details = "";
            double profitLossFromOutlets = 0;
            double profitLossFromThisOutlet = 0;
            double deliveryCosts;
            if (outlets.Count > 1)
            {
                deliveryCosts = baseCostOfDelivery + CalculateDeliveryCost();
            }
            else
            {
                deliveryCosts = baseCostOfDelivery;
            }
            details += "Daily costs for company: " + dailyCosts.ToString() + "\nCost for delivering produce to outlets: " + deliveryCosts.ToString() + "\n";
            for (int current = 0; current < outlets.Count; current++)
            {
                profitLossFromThisOutlet = outlets[current].CalculateDailyProfitLoss(avgCostPerMeal, avgPricePerMeal);
                details += "Outlet " + (current + 1) + " profit/loss: " + profitLossFromThisOutlet.ToString() + "\n";
                profitLossFromOutlets += profitLossFromThisOutlet;
            }
            details += "Previous balance for company: " + balance.ToString() + "\n";
            balance += profitLossFromOutlets - dailyCosts - deliveryCosts;
            details += "New balance for company: " + balance.ToString();
            return details;
        }

        public bool CloseOutlet(int ID)
        {
            bool closeCompany = false;
            outlets.RemoveAt(ID);
            if (outlets.Count == 0)
            {
                closeCompany = true;
            }
            return closeCompany;
        }

        public void ExpandOutlet(int ID)
        {
            int change, result;
            Console.Write("Enter amount you would like to expand the capacity by: ");
            change = Convert.ToInt32(Console.ReadLine());
            result = outlets[ID].AlterCapacity(change);
            if (result == change)
            {
                Console.WriteLine("Capacity adjusted.");
            }
            else
            {
                Console.WriteLine("Only some of that capacity added, outlet now at maximum capacity.");
            }
        }

        public void OpenOutlet(int x, int y)
        {
            int capacity;
            if (category == "fast food")
            {
                balance -= fastFoodOutletCost;
                capacity = fastFoodOutletCapacity;
            }
            else if (category == "family")
            {
                balance -= familyOutletCost;
                capacity = familyFoodOutletCapacity;
            }
            else
            {
                balance -= namedChefOutletCost;
                capacity = namedChefOutletCapacity;
            }
            Outlet newOutlet = new Outlet(x, y, capacity);
            outlets.Add(newOutlet);
        }

        public List<int> GetListOfOutlets()
        {
            List<int> temp = new List<int>();
            for (int current = 0; current < outlets.Count; current++)
            {
                temp.Add(current);
            }
            return temp;
        }

        private double GetDistanceBetweenTwoOutlets(int outlet1, int outlet2)
        {
            return Math.Sqrt((Math.Pow(outlets[outlet1].GetX() - outlets[outlet2].GetX(), 2)) + (Math.Pow(outlets[outlet1].GetY() - outlets[outlet2].GetY(), 2)));
        }

        public double CalculateDeliveryCost()
        {
            List<int> listOfOutlets = new List<int>(GetListOfOutlets());
            double totalDistance = 0;
            double totalCost = 0;
            for (int current = 0; current < listOfOutlets.Count - 1; current++)
            {
                totalDistance += GetDistanceBetweenTwoOutlets(listOfOutlets[current], listOfOutlets[current + 1]);
            }
            totalCost = totalDistance * fuelCostPerUnit;
            return totalCost;
        }
    }

    class Simulation
    {
        private static Random rnd = new Random();
        protected Settlement simulationSettlement;
        protected int noOfCompanies;
        protected double fuelCostPerUnit, baseCostForDelivery;
        protected List<Company> companies = new List<Company>();

        public Simulation()
        {
            fuelCostPerUnit = 0.0098;
            baseCostForDelivery = 100;
            string choice;
            Console.Write("Enter L for a large settlement, anything else for a normal size settlement: ");
            choice = Console.ReadLine();
            if (choice == "L")
            {
                int extraX, extraY, extraHouseholds;
                Console.Write("Enter additional amount to add to X size of settlement: ");
                extraX = Convert.ToInt32(Console.ReadLine());
                Console.Write("Enter additional amount to add to Y size of settlement: ");
                extraY = Convert.ToInt32(Console.ReadLine());
                Console.Write("Enter additional number of households to add to settlement: ");
                extraHouseholds = Convert.ToInt32(Console.ReadLine());
                simulationSettlement = new LargeSettlement(extraX, extraY, extraHouseholds);
            }
            else
            {
                simulationSettlement = new Settlement();
            }
            Console.Write("Enter D for default companies, anything else to add your own start companies: ");
            choice = Console.ReadLine();
            if (choice == "D")
            {
                noOfCompanies = 3;
                Company company1 = new Company("AQA Burgers", "fast food", 100000, 200, 203, fuelCostPerUnit, baseCostForDelivery);
                companies.Add(company1);
                companies[0].OpenOutlet(300, 987);
                companies[0].OpenOutlet(500, 500);
                companies[0].OpenOutlet(305, 303);
                companies[0].OpenOutlet(874, 456);
                companies[0].OpenOutlet(23, 408);
                companies[0].OpenOutlet(412, 318);
                Company company2 = new Company("Ben Thor Cuisine", "named chef", 100400, 390, 800, fuelCostPerUnit, baseCostForDelivery);
                companies.Add(company2);
                Company company3 = new Company("Paltry Poultry", "fast food", 25000, 800, 390, fuelCostPerUnit, baseCostForDelivery);
                companies.Add(company3);
                companies[2].OpenOutlet(400, 390);
                companies[2].OpenOutlet(820, 370);
                companies[2].OpenOutlet(800, 600);
            }
            else
            {
                Console.Write("Enter number of companies that exist at start of simulation: ");
                noOfCompanies = Convert.ToInt32(Console.ReadLine());
                for (int count = 1; count < noOfCompanies + 1; count++)
                {
                    AddCompany();
                }
            }
        }

        public void DisplayMenu()
        {
            Console.WriteLine("\n*********************************");
            Console.WriteLine("**********    MENU     **********");
            Console.WriteLine("*********************************");
            Console.WriteLine("1. Display details of households");
            Console.WriteLine("2. Display details of companies");
            Console.WriteLine("3. Modify company");
            Console.WriteLine("4. Add new company");
            Console.WriteLine("6. Advance to next day");
            Console.WriteLine("Q. Quit");
            Console.Write("\n Enter your choice: ");
        }

        private void DisplayCompaniesAtDayEnd()
        {
            string details;
            Console.WriteLine("\n**********************");
            Console.WriteLine("***** Companies: *****");
            Console.WriteLine("**********************\n");
            foreach (var c in companies)
            {
                Console.WriteLine(c.GetName());
                Console.WriteLine();
                details = c.ProcessDayEnd();
                Console.WriteLine(details + "\n");
            }
        }

        private void ProcessAddHouseholdsEvent()
        {
            int NoOfNewHouseholds = rnd.Next(1, 5);
            for (int i = 1; i < NoOfNewHouseholds + 1; i++)
            {
                simulationSettlement.AddHousehold();
            }
            Console.WriteLine(NoOfNewHouseholds.ToString() + " new households have been added to the settlement.");
        }

        private void ProcessCostOfFuelChangeEvent()
        {
            double fuelCostChange = rnd.Next(1, 10) / 10.0;
            int upOrDown = rnd.Next(0, 2);
            int companyNo = rnd.Next(0, companies.Count);
            if (upOrDown == 0)
            {
                Console.WriteLine("The cost of fuel has gone up by " + fuelCostChange.ToString() + " for " + companies[companyNo].GetName());
            }
            else
            {
                Console.WriteLine("The cost of fuel has gone down by " + fuelCostChange.ToString() + " for " + companies[companyNo].GetName());
                fuelCostChange *= -1;
            }
            companies[companyNo].AlterFuelCostPerUnit(fuelCostChange);
        }

        private void ProcessReputationChangeEvent()
        {
            double reputationChange = rnd.Next(1, 10) / 10.0;
            int upOrDown = rnd.Next(0, 2);
            int companyNo = rnd.Next(0, companies.Count);
            if (upOrDown == 0)
            {
                Console.WriteLine("The reputation of " + companies[companyNo].GetName() + " has gone up by " + reputationChange.ToString());
            }
            else
            {
                Console.WriteLine("The reputation of " + companies[companyNo].GetName() + " has gone down by " + reputationChange.ToString());
                reputationChange *= -1;
            }
            companies[companyNo].AlterReputation(reputationChange);
        }

        private void ProcessCostChangeEvent()
        {
            double costToChange = rnd.Next(0, 2);
            int upOrDown = rnd.Next(0, 2);
            int companyNo = rnd.Next(0, companies.Count);
            double amountOfChange;
            if (costToChange == 0)
            {
                amountOfChange = rnd.Next(1, 20) / 10.0;
                if (upOrDown == 0)
                {
                    Console.WriteLine("The daily costs for " + companies[companyNo].GetName() + " have gone up by " + amountOfChange.ToString());
                }
                else
                {
                    Console.WriteLine("The daily costs for " + companies[companyNo].GetName() + " have gone down by " + amountOfChange.ToString());
                    amountOfChange *= -1;
                }
                companies[companyNo].AlterDailyCosts(amountOfChange);
            }
            else
            {
                amountOfChange = rnd.Next(1, 10) / 10.0;
                if (upOrDown == 0)
                {
                    Console.WriteLine("The average cost of a meal for " + companies[companyNo].GetName() + " has gone up by " + amountOfChange.ToString());
                }
                else
                {
                    Console.WriteLine("The average cost of a meal for " + companies[companyNo].GetName() + " has gone down by " + amountOfChange.ToString());
                    amountOfChange *= -1;
                }
                companies[companyNo].AlterAvgCostPerMeal(amountOfChange);
            }
        }

        private void DisplayEventsAtDayEnd()
        {
            Console.WriteLine("\n***********************");
            Console.WriteLine("*****   Events:   *****");
            Console.WriteLine("***********************\n");
            double eventRanNo;
            eventRanNo = rnd.NextDouble();
            if (eventRanNo < 0.25)
            {
                eventRanNo = rnd.NextDouble();
                if (eventRanNo < 0.25)
                {
                    ProcessAddHouseholdsEvent();
                }
                eventRanNo = rnd.NextDouble();
                if (eventRanNo < 0.5)
                {
                    ProcessCostOfFuelChangeEvent();
                }
                eventRanNo = rnd.NextDouble();
                if (eventRanNo < 0.5)
                {
                    ProcessReputationChangeEvent();
                }
                eventRanNo = rnd.NextDouble();
                if (eventRanNo >= 0.5)
                {
                    ProcessCostChangeEvent();
                }
            }
            else
            {
                Console.WriteLine("No events.");
            }
        }

        public void ProcessDayEnd()
        {
            double totalReputation = 0;
            List<double> reputations = new List<double>();
            int companyRNo, current, loopMax, x = 0, y = 0;
            foreach (var c in companies)
            {
                c.NewDay();
                totalReputation += c.GetReputationScore();
                reputations.Add(totalReputation);
            }
            loopMax = simulationSettlement.GetNumberOfHouseholds() - 1;
            for (int counter = 0; counter < loopMax + 1; counter++)
            {
                if (simulationSettlement.FindOutIfHouseholdEatsOut(counter, ref x, ref y))
                {
                    companyRNo = rnd.Next(1, Convert.ToInt32(totalReputation) + 1);
                    current = 0;
                    while (current < reputations.Count)
                    {
                        if (companyRNo < reputations[current])
                        {
                            companies[current].AddVisitToNearestOutlet(x, y);
                            break;
                        }
                        current++;
                    }
                }
            }
            DisplayCompaniesAtDayEnd();
            DisplayEventsAtDayEnd();
        }

        private void AddCompany()
        {
            int balance, x = 0, y = 0;
            string companyName, typeOfCompany = "9";
            Console.Write("Enter a name for the company: ");
            companyName = Console.ReadLine();
            Console.Write("Enter the starting balance for the company: ");
            balance = Convert.ToInt32(Console.ReadLine());
            while (typeOfCompany != "1" && typeOfCompany != "2" && typeOfCompany != "3")
            {
                Console.Write("Enter 1 for a fast food company, 2 for a family company or 3 for a named chef company: ");
                typeOfCompany = Console.ReadLine();
            }
            if (typeOfCompany == "1")
            {
                typeOfCompany = "fast food";
            }
            else if (typeOfCompany == "2")
            {
                typeOfCompany = "family";
            }
            else
            {
                typeOfCompany = "named chief";
            }
            simulationSettlement.GetRandomLocation(ref x, ref y);
            Company newCompany = new Company(companyName, typeOfCompany, balance, x, y, fuelCostPerUnit, baseCostForDelivery);
            companies.Add(newCompany);
        }

        public int GetIndexOfCompany(string companyName)
        {
            int index = -1;
            for (int current = 0; current < companies.Count; current++)
            {
                if (companies[current].GetName().ToLower() == companyName.ToLower())
                {
                    return current;
                }
            }
            return index;
        }

        public void ModifyCompany(int index)
        {
            string choice;
            int outletIndex, x, y;
            bool closeCompany;
            Console.WriteLine("\n*********************************");
            Console.WriteLine("*******  MODIFY COMPANY   *******");
            Console.WriteLine("*********************************");
            Console.WriteLine("1. Open new outlet");
            Console.WriteLine("2. Close outlet");
            Console.WriteLine("3. Expand outlet");
            Console.Write("\nEnter your choice: ");
            choice = Console.ReadLine();
            if (choice == "2" || choice == "3")
            {
                Console.Write("Enter ID of outlet: ");
                outletIndex = Convert.ToInt32(Console.ReadLine());
                if (outletIndex > 0 && outletIndex <= companies[index].GetNumberOfOutlets())
                {
                    if (choice == "2")
                    {
                        closeCompany = companies[index].CloseOutlet(outletIndex - 1);
                        if (closeCompany)
                        {
                            Console.WriteLine("That company has now closed down as it has no outlets.");
                            companies.RemoveAt(index);
                        }
                    }
                    else
                    {
                        companies[index].ExpandOutlet(outletIndex - 1);
                    }
                }
                else
                {
                    Console.WriteLine("Invalid outlet ID.");
                }
            }
            else if (choice == "1")
            {
                Console.Write("Enter X coordinate for new outlet: ");
                x = Convert.ToInt32(Console.ReadLine());
                Console.Write("Enter Y coordinate for new outlet: ");
                y = Convert.ToInt32(Console.ReadLine());
                if (x >= 0 && x < simulationSettlement.GetXSize() && y >= 0 && y < simulationSettlement.GetYSize())
                {
                    companies[index].OpenOutlet(x, y);
                }
                else
                {
                    Console.WriteLine("Invalid coordinates.");
                }
            }
            Console.WriteLine();
        }

        public void DisplayCompanies()
        {
            Console.WriteLine("\n*********************************");
            Console.WriteLine("*** Details of all companies: ***");
            Console.WriteLine("*********************************\n");
            foreach (var c in companies)
            {
                Console.WriteLine(c.GetDetails() + "\n");
            }
            Console.WriteLine();
        }

        public void Run()
        {
            string choice = "";
            int index;
            while (choice != "Q")
            {
                DisplayMenu();
                choice = Console.ReadLine();
                switch (choice)
                {
                    case "1":
                        simulationSettlement.DisplayHouseholds();
                        break;
                    case "2":
                        DisplayCompanies();
                        break;
                    case "3":
                        string companyName;
                        index = -1;
                        while (index == -1)
                        {
                            Console.Write("Enter company name: ");
                            companyName = Console.ReadLine();
                            index = GetIndexOfCompany(companyName);
                        }
                        ModifyCompany(index);
                        break;
                    case "4":
                        AddCompany();
                        break;
                    case "6":
                        ProcessDayEnd();
                        break;
                    case "Q":
                        Console.WriteLine("Simulation finished, press Enter to close.");
                        Console.ReadLine();
                        break;
                }
            }
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Simulation thisSim = new Simulation();
            thisSim.Run();
        }
    }
}
